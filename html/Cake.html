<!DOCTYPE HTML>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <title>Happy Birthday!</title>
<!--    <link rel="icon" href="./img/favicon.ico">-->
    <link href="../css/stylex.css" type="text/css" rel="stylesheet">
    <script src="../js/jquery-1.js"></script>
    <script src="../js/garden.js"></script>
    <script src="../js/functions.js"></script>
    <style>
        /*pc上宽与高调为80px*/
        iframe {
            position: fixed;
            top: 2px;
            right: 2px;
            width: 8vh;
            height: 8vh;
            border: none;
            z-index: 99999;
        }
    </style>
</head>

<body>
<iframe src="player.html"></iframe>
<div id="mainDiv">
    <div id="content">
        <div id="code">
            <div class="comments" style="white-space: pre-line;">
                亲爱的巧克力：
                在你生日到来之际，我将快乐的音符，作为礼物送给你。
                愿您拥有365个美丽的日子，衷心地祝福你，生日快乐！
                在此诚挚地献上我的三个祝愿：
                一愿你身体健康；二愿你幸福快乐；三愿你万事如意！
                送你一个生日蛋糕，祝你生日快乐！
                第一层，体贴！第二层，关怀！
                第三层，浪漫！第四层，温馨！
                中间夹层，甜蜜！祝你天天都有一份好心情！
            </div>
            <p><a href="./EasterEgg.html" style="margin-left: 240px; text-decoration: underline;">还有彩蛋哟</a></p>
        </div>

        <div id="loveHeart">
            <canvas id="garden"></canvas>
            <div id="words">
                <div id="messages">
                    <img src="../img/zsr.png">
                </div>
                <div id="loveu">
                    <img src="../img/sr.png">
                </div>
            </div>
        </div>
    </div>
    <div id="copyright">
        <center>
            <link rel="stylesheet" href="../css/cuplayer.css">
            <div style="position:absolute; top:50px; right:50px;">
            </div>

            <script>

                // 获取文本框元素
                const codeElement = document.getElementById('code');

                // 计算文本框内容的实际高度
                const contentHeight = codeElement.scrollHeight;

                // 设置文本框的固定高度
                codeElement.style.height = `${contentHeight}px`;

                // 定义动画函数
                let currentHeight = 0;
                const totalHeight = contentHeight;
                const interval = 250; // 每隔 0.25 秒，使文本框展开更慢
                const step = totalHeight / (totalHeight / 26); // 每行高度为 26px

                const animateTextBox = () => {
                    currentHeight += step; // 每次增加一行的高度
                    if (currentHeight <= totalHeight) {
                        codeElement.style.clipPath = `polygon(0 0, 100% 0, 100% ${currentHeight}px, 0 ${currentHeight}px)`;
                    } else {
                        clearInterval(animationInterval); // 动画结束，清除定时器
                    }
                };

                // 启动动画
                const animationInterval = setInterval(animateTextBox, interval);
            </script>


            <script type="text/javascript">
                //获取picid函数
                $(function () {
                    $("area").click(function () {
                        var picId = $(this).attr("data-id");
                        var picSrc = "img/img_big/" + picId + ".jpg"
                        $(".modal-content>.pic-box>img").attr("src", picSrc);
                    })
                    var isPlaying = function (audio) {
                        return !audio.paused;
                    }
                    var a = document.getElementById('main_audio');
                    if (!(a.play instanceof Function)) {
                        a = document.getElementById('main_audio_ie8');
                        isPlaying = function (audio) {
                            return audio.playState == 2;
                        }
                    }
                    $('#btn-play').on('click', function () {
                        if ($(this).hasClass('rotate')) {
                            a.pause();
                            $(this).removeClass('rotate');
                        } else {
                            a.play();
                            $(this).addClass('rotate');
                        }
                    });

                })
            </script>

        </center>
    </div>
</div>
<script type="text/javascript">
    var offsetX = $("#loveHeart").width() / 2;
    var offsetY = $("#loveHeart").height() / 2 - 55;
    var together = new Date();
    together.setHours(8);
    together.setMinutes(0);
    together.setSeconds(0);
    together.setMilliseconds(0);

    if (!document.createElement('canvas').getContext) {
        var msg = document.createElement("div");
        msg.id = "errorMsg";
        msg.innerHTML = "您的浏览器已经过时!请使用非IE浏览器进行预览";
        document.body.appendChild(msg);
        $("#code").css("display", "none")
        $("#copyright").css("position", "absolute");
        $("#copyright").css("bottom", "10px");
        document.execCommand("stop");
    } else {
        setTimeout(function () {
            startHeartAnimation();
        }, 3000);  // 将5000改为3000，进一步减少延迟时间，使蛋糕更早展示

        timeElapse(together);
        setInterval(function () {
            timeElapse(together);
        }, 500);

        adjustCodePosition();
        $("#code").typewriter();
    }
</script>
</body>
</html>